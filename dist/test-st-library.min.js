var TestStLibrary=function(e){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){s=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}(e,t)||a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var o={noData:{en:"No data appears to be present at the moment",it:"Al momento non sembra essere presente alcun dato"},noStart:{en:"A node has not been selected to start the story from",it:"Non è stato selezionato un nodo da cui iniziare la storia"},noEnd:{en:"an end node has not been inserted",it:"non è stato inserito un nodo finale"},nodeBadMix:{it:"the resulting list of nodes is incorrect (nodes to be disconnected:",en:""},expressionIncoplete:{it:"l'espressione usata è incopleta",en:"the expression used is incomplete"},linkNodeEmpty:{it:"Il nodo link è vuoto",en:"The link node is empty"},redirectError:{it:"Non sono stati specificati alcuni nodi di destinazione",en:"Some target nodes were not specified"}},s={postInfo:{title:"Placeholder",lenghtDescriptionsNode:400,lenghtChoseNode:20,selectedWorkSpace:1,privateLink:!0,langList:["it","en"]},erorList:{noStart:!1},MaxId:16,levels:[],achievements:[],items:[],stats:[],story:{tabs:[{id:1,humanName:{default:"start"},level:0,name:"start",type:"start",gameStart:!0,levelStart:!1,x:607,y:68.8125},{id:2,humanName:{default:"text",textImage:"text & image"},level:0,name:"descriptions0",text:{it:"Questa è una storia segnaposto, sei interessato a proseguire?",en:"This is a placeholder story"},type:"descriptions",img:{ID:1315,srcFull:["http://localhost/storyground-editor/wp-content/uploads/2022/01/29695f55c408397b6eeb453fb59d40d9_img-1.jpg",1920,1080,!1],srcThumbnail:["http://localhost/storyground-editor/wp-content/uploads/2022/01/29695f55c408397b6eeb453fb59d40d9_img-1-150x150.jpg",150,150,!0],post_name:"29695f55c408397b6eeb453fb59d40d9_img-1"},save:!1,textRevision:!1,x:576,y:189.8125},{id:4,humanName:{default:"choice"},level:0,name:"chose0",text:{it:"si",en:"yes"},type:"chose",textRevision:!1,x:480,y:531.8125},{id:5,humanName:{default:"choice"},level:0,name:"chose1",text:{it:"no",en:"no"},type:"chose",textRevision:!1,x:781,y:595.8125},{id:10,humanName:{default:"text",textImage:"text & image"},level:0,name:"descriptions1",text:{it:"Non c'è molto altro da dire, come ti ho detto...",en:"There isn't much more to say, as I told you...\r"},type:"descriptions",img:!1,save:!1,textRevision:!1,x:473,y:681.8125},{id:11,humanName:{default:"null"},level:0,type:"null",x:149,y:319.8125,name:"null0"},{id:15,humanName:{default:"end"},level:0,name:"end0",type:"end",text:{it:"Allora esci da questa pagina",en:""},img:!1,textRevision:!1,x:884,y:839.8125}],beams:[{id:3,from:1,to:2},{id:8,from:2,to:4},{id:9,from:2,to:5},{id:12,from:10,to:11},{id:13,from:11,to:2},{id:14,from:4,to:10},{id:16,from:5,to:15}]},style:{"font-family":"Twinkle Star","layou-type":1,"img-sizes":[{width:800,height:600},{width:1200,height:992},{width:1920,height:1080}],"bg-color":"#FF0000",color:"#000000","icon-single-arrow":{id:1,size:16,units:"px",color:"#00FF00"},"icon-multiple-arrow":{id:1,size:16,units:"px",color:"#00FF00"},desktop:{"font-size":20,units:"px"},mobile:{"font-size":18,units:"px"}}},l={name:"boxIllustration",props:["illustration","editorUsage","indexMedia","pathMediaDir","style"],methods:{},computed:{imgPathPart:function(){var e=this,t=this.indexMedia.find((function(t){return t.Id==e.illustration.ID})).name;return this.pathMediaDir+"/"+t},responsiveImages:function(){var e=this,t={srcset:"",sizes:""};return this.style["img-sizes"].forEach((function(n,r){t.srcset=t.srcset+e.imgPathPart+"-"+n.width+"x"+n.height+".jpg "+n.width+"w",r+1!=e.style["img-sizes"].length&&(t.srcset=t.srcset+","),r+1!=e.style["img-sizes"].length?t.sizes=t.sizes+"( max-width:"+n.width+"px ) "+n.width+"px, ":t.sizes=t.sizes+n.width+"px"})),t}},mounted:function(){console.log(this.imgPathPart+"-"),console.log(this.style["img-sizes"][0].width+"x"),console.log(this.style["img-sizes"][0].height+".jpg")}},c={class:"box-illustration"},d=["src"],u=["src","srcset","sizes"];l.render=function(t,n,r,a,i,o){return e.openBlock(),e.createElementBlock("div",c,[e.createElementVNode("div",{class:"inner-box",style:e.normalizeStyle({paddingBottom:t.illustration.srcFull[2]/t.illustration.srcFull[1]*100+"%"})},[t.editorUsage?(e.openBlock(),e.createElementBlock("img",{key:0,class:"box-img",src:t.illustration.srcFull[0]},null,8,d)):(e.openBlock(),e.createElementBlock("img",{key:1,src:t.imgPathPart+"-"+t.style["img-sizes"][t.style["img-sizes"].length-1].width+"x"+t.style["img-sizes"][t.style["img-sizes"].length-1].height+".jpg",srcset:t.responsiveImages.srcset,sizes:t.responsiveImages.sizes},null,8,u))],4)])};var m={name:"boxNarration",props:["currentTabs","lang","reedbeams"],methods:{reedBeams:function(e){this.$emit("reedbeams",e)}}},p={class:"box-narration"},h={class:"tab-results"},f={key:0,class:"p"},g=["onClick"],b={key:0,class:"single-beem-foward-box"};m.render=function(t,n,r,a,i,o){return e.openBlock(),e.createElementBlock("div",p,[e.createElementVNode("div",h,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.currentTabs,(function(n,r){return e.openBlock(),e.createElementBlock("div",{key:n.id,class:e.normalizeClass(1==t.currentTabs.length?"label-description":"label-multiple-chose")},[1==t.currentTabs.length?(e.openBlock(),e.createElementBlock("div",f,e.toDisplayString(n.text[t.lang]),1)):(e.openBlock(),e.createElementBlock("div",{key:1,onClick:function(e){return t.reedBeams(n.id)},class:"p"},e.toDisplayString(n.text[t.lang]),9,g))],2)})),128))]),1==t.currentTabs.length?(e.openBlock(),e.createElementBlock("div",b,[e.createElementVNode("div",{onClick:n[0]||(n[0]=function(e){return t.reedBeams(t.currentTabs[0].id)}),class:"icon-proceed"})])):e.createCommentVNode("",!0)])};var y={name:"boxNarrationGameEnd",props:["currentTabs","lang","reedbeams"],methods:{reedBeams:function(e){this.$emit("reedbeams",e)}}},v={class:"box-narration"},x={class:"tab-results"},k={key:0,class:"p"};y.render=function(t,n,r,a,i,o){return e.openBlock(),e.createElementBlock("div",v,[e.createElementVNode("div",x,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.currentTabs,(function(n,r){return e.openBlock(),e.createElementBlock("div",{key:n.id,class:e.normalizeClass(1==t.currentTabs.length?"label-description":"label-multiple-chose")},[1==t.currentTabs.length?(e.openBlock(),e.createElementBlock("div",k,e.toDisplayString(n.text[t.lang]),1)):e.createCommentVNode("",!0)],2)})),128))])])};var B={name:"boxNarrationGameOver",props:["currentTabs","lang","reedbeams"],methods:{reedBeams:function(e){this.$emit("reedbeams",e)}}},E={class:"box-narration"},I={class:"tab-results"},S={key:0,class:"p"};B.render=function(t,n,r,a,i,o){return e.openBlock(),e.createElementBlock("div",E,[e.createElementVNode("div",I,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.currentTabs,(function(n,r){return e.openBlock(),e.createElementBlock("div",{key:n.id,class:e.normalizeClass(1==t.currentTabs.length?"label-description":"label-multiple-chose")},[1==t.currentTabs.length?(e.openBlock(),e.createElementBlock("div",S,e.toDisplayString(n.text[t.lang]),1)):e.createCommentVNode("",!0)],2)})),128))])])};var D={name:"boxText",props:["narrationBox","lang","currentTabs","reedBeams"],components:{boxnarration:m,gameEnd:y,gameOver:B}};function T(e){var n;if("object"===t(e))if(null===e)n=null;else switch(toString.call(e)){case"[object Array]":n=e.map(T);break;case"[object Date]":n=new Date(e);break;case"[object RegExp]":n=new RegExp(e);break;default:n=Object.keys(e).reduce((function(t,n){return t[n]=T(e[n]),t}),{})}else n=e;return n}D.render=function(t,n,r,a,i,o){var s=e.resolveComponent("boxnarration"),l=e.resolveComponent("gameEnd"),c=e.resolveComponent("gameOver");return e.openBlock(),e.createElementBlock("span",null,["default"==t.narrationBox||"descriptions"==t.narrationBox||"chose"==t.narrationBox?(e.openBlock(),e.createBlock(s,{key:0,lang:t.lang,"current-tabs":t.currentTabs,onReedBeams:n[0]||(n[0]=function(e){return t.emit("reedBeams")})},null,8,["lang","current-tabs"])):e.createCommentVNode("",!0),"end"==t.narrationBox?(e.openBlock(),e.createBlock(l,{key:1,lang:t.lang,"current-tabs":t.currentTabs,onReedBeams:n[1]||(n[1]=function(e){return t.emit("reedBeams")})},null,8,["lang","current-tabs"])):e.createCommentVNode("",!0),"game over"==t.narrationBox?(e.openBlock(),e.createBlock(c,{key:2,lang:t.lang,"current-tabs":t.currentTabs,onReedBeams:n[2]||(n[2]=function(e){return t.emit("reedBeams")})},null,8,["lang","current-tabs"])):e.createCommentVNode("",!0)])};var w=e.defineComponent({name:"game",components:{boxillustration:l,boxText:D},props:{editorUsage:{type:Boolean,default:!1},propLang:{type:String,default:"null-lang"},langEditor:{type:String,default:"en"},strings:{type:Object,default:o},gameData:{type:Object,default:s},indexMedia:{type:Object,default:[{Id:1315,name:"29695f55c408397b6eeb453fb59d40d9_img-1"}]},pathMediaDir:{type:String,default:"./media"}},data:function(){return{lang:!1,textualTabs:["descriptions","chose","game over","end"],playerState:"playing",player:{item:[]},currentTabs:[],illustration:!1,onRunError:[],listBadMixId:"",cover:!0,gameLoaded:!1}},watch:{narrationBox:function(e){"node-bad-mix"==e&&this.setListBadMixId()}},mounted:function(){"null-lang"!==this.propLang?this.lang=this.propLang:this.lang=this.gameData.postInfo.langList[0],this.gameIntentLoad()},computed:{narrationBox:function(){if(this.onRunError.length>0)return"false";if(this.currentTabs.length>0){if(1==this.currentTabs.length)return this.currentTabs[0].type;var e=["chose"];return this.currentTabs.filter((function(t){return e.includes(t.type)})).length==this.currentTabs.length?"default":"node-bad-mix"}return!1}},methods:{gameIntentLoad:function(){var e=this;this.playerState="playing",this.player={stats:[],item:[]},this.gameData.stats&&this.gameData.stats.forEach((function(t){var n=T(t);n.level=0,e.player.stats.push(n)})),this.setPlayerItemFiltered();var t=[],n=this.gameData.story.tabs.find((function(e){return e.gameStart})).id;t.push(n),this.navigation(t)},navigation:function(e){var t=this.gameData.story.tabs.filter((function(t){return e.includes(t.id)})),n=this.ResoveTabsList(t);0==n.length?this.error="!!! -- id tabs sbagliato -- !!":(1==n.length?(this.singleBeemFoward=!0,n[0].img&&this.setImage(n[0].img),1==n[0].save&&this.saveData()):this.singleBeemFoward=!1,this.currentTabs=n)},ResoveTabsList:function(e){for(var t=this,n=!1,a=0,i=this.textualTabs,o=e,s=function(){a++;var e=!0,s=[];o.forEach((function(n){i.includes(n.type)?s.push(n):(e=!1,s=[].concat(r(s),r(t.ResoveTab(n))))})),o=s,(1==e||a>=100)&&(n=!0)};0==n;)s();return o},ResoveTab:function(e){function n(e,t,n){var r=parseInt(e),a=parseInt(n);switch(t){case">":return r>a;case">=":return r>=a;case"<":return r<a;case"<=":return r<=a;case"==":return r==a}}var r,a,i,o=[],s=!1;switch((r="object"===t(e)?e:this.gameData.story.tabs.find((function(t){return t.id==e}))).type){case"start":break;case"descriptions":case"chose":o.push(r),s=!0;break;case"game over":this.playerState="game over",o.push(r),s=!0;break;case"end":this.playerState="game end",o.push(r),s=!0;break;case"redirect":var l=!1;if(r.listRedirectId.length>0?r.listRedirectId.forEach((function(e){e||(l=!0)})):l=this.strings.linkNodeEmpty[this.langEditor]+" ( ID: "+r.id+" )",0==l){var c;if(1==r.listRedirectId.length)c=r.listRedirectId[0];else{var d=(a=0,i=r.listRedirectId.length-1,Math.floor(Math.random()*(i-a+1)+a));c=r.listRedirectId[d]}var u=this.gameData.story.tabs.find((function(e){return e.id==c}));r=u}else{var m=this.strings.redirectError.langEditor+" ( ID: "+r.id+" )";this.onRunError.push(m),s=!0}l&&(this.onRunError.push(l),s=!0);break;case"set stat":var p=this.gameData.stats.find((function(e){return e.id==r.idStat}));if(p)if(0==p.length||0==r.operator){var h=this.strings.expressionIncoplete.langEditor+" ( ID: "+r.id+" )";this.onRunError.push(h),s=!0}else this.modifyStat(r.idStat,r.operator,r.ammount);else{var f=this.strings.expressionIncoplete.langEditor+" ( ID: "+r.id+" )";this.onRunError.push(f),s=!0}break;case"set object":var g=this.gameData.items.find((function(e){return e.id==r.idObject}));if(g)if(0==g.length||0==r.operator){var b=this.strings.expressionIncoplete.langEditor+" ( ID: "+r.id+" )";this.onRunError.push(b),s=!0}else this.modifyItem(r.idObject,r.operator,r.ammount);else{var y=this.strings.expressionIncoplete.langEditor+" ( ID: "+r.id+" )";this.onRunError.push(y),s=!0}break;case"if stat":var v=this.player.stats.find((function(e){return e.id==r.idStat}));if(v)if(!1===r.ammount||null==r.ammount||0==r.operator){var x=this.strings.expressionIncoplete.langEditor+" ( ID: "+r.id+" )";this.onRunError.push(x),s=!0}else{if(n(v.level,r.operator,r.ammount)){var k=this.gameData.story.tabs.filter((function(e){return r.trueId.includes(e.id)}));o=k,s=!0}else{var B=this.gameData.story.tabs.filter((function(e){return r.falseId.includes(e.id)}));o=B,s=!0}}else{var E=this.strings.expressionIncoplete.langEditor+" ( ID: "+r.id+" )";this.onRunError.push(E),s=!0}break;case"if item":var I=this.player.item.filter((function(e){return e.id==r.idObject})).length,S=this.gameData.items.find((function(e){return e.id==r.idObject}));if(S)if(0==S.length||0==r.operator){var D=this.strings.expressionIncoplete.langEditor+" ( ID: "+r.id+" )";this.onRunError.push(D),s=!0}else{if(n(I,r.operator,r.ammount)){var T=this.gameData.story.tabs.filter((function(e){return r.trueId.includes(e.id)}));o=T,s=!0}else{var w=this.gameData.story.tabs.filter((function(e){return r.falseId.includes(e.id)}));o=w,s=!0}}else{var R=this.strings.expressionIncoplete.langEditor+" ( ID: "+r.id+" )";this.onRunError.push(R),s=!0}}return 0==s&&(this.gameData.story.beams.forEach((function(e){r.id==e.from&&o.push(e.to)})),s=!0),o},modifyStat:function(e,t,n){var r,a,i=this.gameData.stats.find((function(t){return t.id==e})),o=this.player.stats.find((function(t){return t.id==e}));switch(t){case"+":r=n,a=1;break;case"-":r=n,a=2;break;case"*":r=parseInt(o.level)*parseInt(n),a=1;break;case"/":r=Math.floor(parseInt(o.level)/parseInt(n)),a=2;break;case"=":r=n,a=5}1==a&&(o.level=parseInt(o.level)+parseInt(r)),2==a&&(o.level=parseInt(o.level)-parseInt(r)),5==a&&(o.level=r),o.level>i.max&&(o.level=i.max),o.level<0&&!isNaN(o.level)&&(o.level=0)},modifyItem:function(e,t,n){var r,a,i=this.gameData.items.find((function(t){return t.id==e})),o=this.player.item.filter((function(e){return e.id==i.id})).length;switch(t){case"+":r=n,a=1;break;case"-":r=n,a=2;break;case"*":r=parseInt(o)*parseInt(n),a=1;break;case"/":r=parseInt(o)-Math.floor(parseInt(o)/parseInt(n)),a=2;break;case"=":n<o?(r=o-n,a=2):(r=n-o,a=1)}if(1==a)for(var s=0;s<r;s++)this.player.item.push(i);if(2==a){var l=[],c=0;this.player.item.forEach((function(e){i.id==e.id?++c<=o-r&&l.push(e):l.push(e)})),this.player.item=l}this.setPlayerItemFiltered()},reedBeams:function(e){var t=[];this.gameData.story.beams.forEach((function(n){e==n.from&&t.push(n.to)})),this.navigation(t)},saveData:function(){},setImage:function(e){this.illustration=e},animatePaperSelector:function(){var e=this;1==this.hoveCharacterSheet&&("stats"==this.subTabCharacterSheet?this.player.stats.forEach((function(t){t.id==e.seletedItem?t.active=2:0!=t.active&&(t.active=1)})):this.playerItemFiltered.forEach((function(t){t.id==e.seletedItem?t.active=2:0!=t.active&&(t.active=1)})))},clearAnimatePaperSelector:function(){this.player.stats.forEach((function(e){e.active=0})),this.player.item.forEach((function(e){e.active=0}))},setDescriptionPaper:function(e){var t=this;this.seletedItem=e.id,this.animatePaperSelector(),this.descriptionPaperName=e.name[this.lang],this.descriptionPaperDescription=e.description[this.lang],this.oldItemTap=this.itemTap,this.itemTap=this.itemTap+1,setTimeout((function(){0==t.itemTap&&(t.seletedItem=!1,t.animatePaperSelector())}),4e3)},setPlayerItemFiltered:function(){var e=this,t=[];this.player.item.forEach((function(n){if(null==t.find((function(e){return e.id==n.id}))){var r=e.player.item.filter((function(e){return e.id==n.id})).length,a=Object.assign({},n);a.amount=r,t.push(a)}})),this.playerItemFiltered=t},setListBadMixId:function(){var e="",t=this.currentTabs.filter((function(e){return"descriptions"==e.type}));t.forEach((function(n,r){e+=n.id,r+1<t.length&&(e+=", ")})),this.listBadMixId=e},activateDemo:function(){!function(e){var t=e.requestFullScreen||e.webkitRequestFullScreen||e.mozRequestFullScreen||e.msRequestFullScreen;if(t)t.call(e);else if(void 0!==window.ActiveXObject){var n=new ActiveXObject("WScript.Shell");null!==n&&n.SendKeys("{F11}")}}(document.body)}}}),R={class:"game-grid"},N={key:1,class:"log-app"},z={key:0,class:"game-error e-1"},j={key:1,class:"game-error e-3"};w.render=function(t,n,r,a,i,o){var s=e.resolveComponent("boxillustration"),l=e.resolveComponent("boxText");return e.openBlock(),e.createElementBlock("div",R,[t.illustration?(e.openBlock(),e.createBlock(s,{key:0,editorUsage:t.editorUsage,illustration:t.illustration,indexMedia:t.indexMedia,pathMediaDir:t.pathMediaDir,style:e.normalizeStyle(t.gameData.style)},null,8,["editorUsage","illustration","indexMedia","pathMediaDir","style"])):e.createCommentVNode("",!0),e.createVNode(l,{narrationBox:t.narrationBox,lang:t.lang,"current-tabs":t.currentTabs,onReedBeams:t.reedBeams},null,8,["narrationBox","lang","current-tabs","onReedBeams"]),"false"==t.narrationBox||"node-bad-mix"==t.narrationBox?(e.openBlock(),e.createElementBlock("div",N,[0==t.narrationBox&&0==t.onRunError.length?(e.openBlock(),e.createElementBlock("div",z,e.toDisplayString(t.strings.noEnd.langEditor),1)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.onRunError,(function(t,n){return e.openBlock(),e.createElementBlock("div",{key:n,class:"game-error e-2"},e.toDisplayString(t),1)})),128)),"node-bad-mix"==t.narrationBox?(e.openBlock(),e.createElementBlock("div",j,e.toDisplayString(t.strings.nodeBadMix.langEditor)+" "+e.toDisplayString(t.listBadMixId)+" ) ",1)):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass(["cover",{"hide-cover":0==t.cover}])},null,2)])};var C=Object.freeze({__proto__:null,game:w}),F=function(e){Object.entries(C).forEach((function(t){var r=n(t,2),a=r[0],i=r[1];e.component(a,i)}))},M=Object.freeze({__proto__:null,default:F,game:w});return Object.entries(M).forEach((function(e){var t=n(e,2),r=t[0],a=t[1];"default"!==r&&(F[r]=a)})),F}(Vue);